---
title: vueæºç é˜…è¯»ä¸€
date: 2020-11-10 14:20:47
tags: vue æºç 
---

## æ„å»ºæºç é˜…è¯»ç¯å¢ƒ

æ„å»ºä¸€ä¸ªæœ€ç®€å•çš„æºç ç¯å¢ƒåªéœ€è¦ä¸€ä¸ªvue.jsæ–‡ä»¶å³å¯ã€‚
å·¥ç¨‹åŒ–çš„vueæºç é¡¹ç›®ä¼šæ·»åŠ äº†å¾ˆå¤šå…¶ä»–ä¸œè¥¿ï¼Œæ¯”å¦‚flowç±»å‹æ£€æµ‹,ä¸ªäººè§‰å¾—å·¥ç¨‹åŒ–æ˜¯ä¸ªå¾ˆå¤æ‚çš„ï¼Œä¼šå¤šäº†å¾ˆå¤šå…¶ä»–å¹²æ‰°ã€‚
æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è¯»æºç ï¼Œæ‰€ä»¥åªéœ€è¦æœ€ç®€å•çš„ï¼Œçº¯ç²¹æºç æ–‡ä»¶å³å¯ã€‚
å·¥ç¨‹åªä½œä¸ºè¾…åŠ©ä½œç”¨ï¼Œä»¥åå¯ä»¥å­¦ä¹ å·¥ç¨‹çš„è®¾è®¡æ€æƒ³ï¼Œæˆ–è€…æ ¹æ®åŠŸèƒ½ï¼Œå•ç‹¬çš„å­¦ä¹ ï¼Œæ¯”å¦‚å·¥å…·ç±»ã€‚

å¼€å§‹è¯»æºç ï¼Œå‚è€ƒäº†ä¸€äº›èµ„æ–™ã€‚
æ¯”å¦‚å·¥ç¨‹æ­å»ºï¼Œå°±æ˜¯çœ‹äº†å‚è€ƒä¸€ï¼Œå½“æ—¶å†…å¿ƒå°±æ˜¯è¿™æ ·ğŸ˜®ã€‚

- [å‚è€ƒä¸€](https://github.com/qq281113270/vue)

- [å‚è€ƒäºŒ](http://hcysun.me/vue-design/zh/essence-of-comp.html)

è®¡åˆ’å°±æ˜¯ï¼Œè¾¹çœ‹è¾¹è¡¥ï¼Œä¸æ˜ç™½çš„åœ°æ–¹å°±æ˜¯éœ€è¦è¡¥å……çš„çŸ¥è¯†ç‚¹ã€‚

æ‰€ä»¥è¯»æºç å°±è¦å¼€å§‹å•¦ã€‚

## hello word
å…ˆç”¨npmä¸‹è½½vueåŒ…ç„¶åå†distç›®å½•ä¸‹æ‰¾åˆ°æ‰“åŒ…å¥½çš„vue.jsæ–‡ä»¶ã€‚

![vue.js](2020-11-10-vueæºç é˜…è¯»ä¸€/vue.png)

åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹å†…åˆ›å»ºä¸€ä¸ªhtmlæ–‡ä»¶ï¼Œç„¶åå¼•å…¥vue.jsã€‚

```js
<script src = "vue.js"></script>
```


ç¬¬ä¸€æ­¥new ä¸€ä¸ª Vueã€‚

```js
var app = new Vue();
console.log(app);
```

å¯ä»¥çœ‹åˆ°ä¸€ä¸ªvueå¯¹è±¡ä¸‹æœ‰å¾ˆå¤šå±æ€§
![new-vue](2020-11-10-vueæºç é˜…è¯»ä¸€/new-vue.jpg)

æ‰“å¼€vue.js,å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°.åªçœ‹è¾“å…¥ä¸è¾“å‡ºï¼Œå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œ
è¾“å‡ºä¸€ä¸ªVueå¯¹è±¡ã€‚

ä¸¤ä¸ªå‚æ•°ï¼Œ
global: thiså³windowå¯¹è±¡ 
factoryï¼šè‡ªæ‰§è¡Œå‡½æ•°ä¼ å…¥çš„ä¸€ä¸ªå‡½æ•°ï¼Œè¶…çº§é•¿çš„å‡½æ•°ï¼Œå‡ ä¹å…¨éƒ¨é€»è¾‘éƒ½åœ¨è¿™ä¸ªå‡½æ•°ã€‚ä»åå­—å¯ä»¥çœ‹å‡ºæ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨å…³é”®å­—newåˆ›å»ºä¸€ä¸ªvueå¯¹è±¡ã€‚

ç¬¬ä¸ƒè¡Œï¼Œåˆ¤æ–­æ˜¯å¦ä½¿ç”¨es6-moduleå¼•å…¥vue.
ç¬¬å…«è¡Œï¼Œåˆ¤æ–­æ˜¯å¦amdå¼•ç”¨æ–¹å¼ã€‚
ç¬¬ä¹è¡Œï¼Œåˆ¤æ–­æ˜¯å¦ç”¨scriptæ–¹å¼å¼•å…¥vue,æ˜¯åˆ™åœ¨Windowå¯¹è±¡ä¸‹æ·»åŠ Vueå±æ€§ï¼ŒVueç­‰äºfactory()çš„è¿”å›å€¼ã€‚


å¦‚æœä¸ä½¿ç”¨å…³é”®å­—new,åˆ™ä¼šæœ‰ä¸€ä¸ªæŠ¥é”™ã€‚åœ¨633è¡Œå’Œ5077è¡Œã€‚

633è¡Œè°ƒç”¨çš„æŠ¥é”™å‡½æ•°è¾“å‡º

æˆ‘ä»¬å»5077è¡Œçœ‹ï¼Œ
```js
  function Vue (options) {
    if (!(this instanceof Vue)
    ) {
      warn('Vue is a constructor and should be called with the `new` keyword');
    }
    this._init(options);
  }
```
å¯ä»¥çœ‹åˆ°Vueæ˜¯ä¸ªå‡½æ•°ï¼Œåˆ¤æ–­thisæ˜¯å¦æ˜¯Vueçš„å®ä¾‹ï¼Œä¸æ˜¯åˆ™æŠ¥é”™ï¼Œæ­¤æ—¶æ‰“å°thisæ˜¯undefined,æ‰€ä»¥undefined._init()ä¼šæŠ¥é”™ã€‚

æ‰§è¡Œæµç¨‹å°±æ˜¯åœ¨å¼•å…¥vue.jsï¼Œå°±ä¼šæ‰§è¡Œç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œç«‹å³æ‰§è¡Œå‡½æ•°ä¼šåœ¨windowå¯¹è±¡ä¸‹å¢åŠ ä¸€ä¸ªVueå±æ€§ã€‚Vueçš„å±æ€§æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚

```js
window: {
    Vue: function Vue (options) {
    if (!(this instanceof Vue)
    ) {
      warn('Vue is a constructor and should be called with the `new` keyword');
    }
    this._init(options);
  }
}
```

è¯æ˜ï¼š
```js
console.log(window.Vue)
```

æ¥ç€å°±æ˜¯newä¸€ä¸ªVueçš„äº‹ï¼Œnew å‡ºæ¥çš„å¯¹è±¡å¸¦çš„è¿™ä¹ˆå¤šå±æ€§æ˜¯æ€ä¹ˆåŠ ä¸Šå»çš„å‘¢ï¼Ÿ

æˆ‘ä»¬å¯ä»¥åœ¨è¿”å›newå¯¹è±¡ä¹‹å‰æ‰“ä¸€ä¸ªæ–­ç‚¹,å¯ä»¥çœ‹åˆ°Vueæ„é€ å‡½æ•°çš„prototypeå·²ç»æ·»åŠ äº†å¾ˆå¤šçš„æ–¹æ³•ã€‚

![vue.prototype](2020-11-10-vueæºç é˜…è¯»ä¸€/vue.prototype.jpg)

```js
$delete: Æ’ del(target, key)
$destroy: Æ’ ()
$emit: Æ’ (event)
$forceUpdate: Æ’ ()
$mount: Æ’ ( el, hydrating )
$nextTick: Æ’ (fn)
$off: Æ’ (event, fn)
$on: Æ’ (event, fn)
$once: Æ’ (event, fn)
$set: Æ’ (target, key, val)
$watch: Æ’ ( expOrFn, cb, options )
__patch__: Æ’ patch(oldVnode, vnode, hydrating, removeOnly)
_b: Æ’ bindObjectProps( data, tag, value, asProp, isSync )
_d: Æ’ bindDynamicKeys(baseObj, values)
_e: Æ’ (text)
_f: Æ’ resolveFilter(id)
_g: Æ’ bindObjectListeners(data, value)
_i: Æ’ looseIndexOf(arr, val)
_init: Æ’ (options)
_k: Æ’ checkKeyCodes( eventKeyCode, key, builtInKeyCode, eventKeyName, builtInKeyName )
_l: Æ’ renderList( val, render )
_m: Æ’ renderStatic( index, isInFor )
_n: Æ’ toNumber(val)
_o: Æ’ markOnce( tree, index, key )
_p: Æ’ prependModifier(value, symbol)
_q: Æ’ looseEqual(a, b)
_render: Æ’ ()
_s: Æ’ toString(val)
_t: Æ’ renderSlot( name, fallback, props, bindObject )
_u: Æ’ resolveScopedSlots( fns, // see flow/vnode res, // the following are added in 2.6 hasDynamicKeys, contentHashKey )
_update: Æ’ (vnode, hydrating)
_v: Æ’ createTextVNode(val)
$data: (...)
$isServer: (...)
$props: (...)
$ssrContext: (...)
constructor: Æ’ Vue(options)
get $data: Æ’ ()
set $data: Æ’ ()
get $isServer: Æ’ ()
get $props: Æ’ ()
set $props: Æ’ ()
get $ssrContext: Æ’ ()
__proto__: Object
```

åœ¨new Vueçš„æ—¶å€™ä¼šæ‰§è¡Œ_initæ–¹æ³•ã€‚æ¥ä¸‹æ¥çœ‹_initæ–¹æ³•åšäº†ä»€ä¹ˆã€‚

æ‰§è¡Œnew Vueæ—¶ï¼Œthis = {}

4411 watcher

> å…³äºnewä¸€ä¸ªå¯¹è±¡ã€‚

new ä¸€ä¸ªå¯¹è±¡éœ€è¦æ„é€ å‡½æ•°ï¼Œæ„é€ å‡½æ•°ï¼Œé¡¾åæ€ä¹‰æ˜¯ä¸ªå‡½æ•°ã€‚


> è‡ªæ‰§è¡Œå‡½æ•°åšäº†ä»€ä¹ˆäº‹

1.è¿”å›Vueæ„é€ å‡½æ•°ã€‚æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡çš„æ–¹æ³•å’Œå±æ€§æ˜¯ä»€ä¹ˆæ—¶å€™åŠ ä¸Šå»çš„ã€‚
ç­”æ¡ˆæ˜¯åœ¨æ‰§è¡Œè‡ªæ‰§è¡Œå‡½æ•°çš„æ—¶å€™ã€‚

```js
  initMixin(Vue);
  stateMixin(Vue);
  eventsMixin(Vue);
  lifecycleMixin(Vue);
  renderMixin(Vue);
```
> initMinx()

æ‰§è¡Œçš„ç¬¬ä¸€ä¸ªå‡½æ•°ï¼Œè®¾ç½®äº†$optionså±æ€§

> stateMixin();

åˆ†åˆ«è®¾ç½®äº†$data,$propså±æ€§ï¼Œè®¾ç½®äº†$set, $delete, $watchæ–¹æ³•.

$dataå’Œ$propså±æ€§çš„setæ–¹æ³•é‡å†™ã€‚æç¤ºäº†è¿™ä¸¤ä¸ªå±æ€§éƒ½æ˜¯åªè¯»ã€‚
getæ–¹æ³•åªåˆ†åˆ«è¿”å› this._data, this._propsã€‚
```js
    dataDef.get = function () { return this._data };
    var propsDef = {};
    propsDef.get = function () { return this._props };
    {
      dataDef.set = function () {
        warn(
          'Avoid replacing instance root $data. ' +
          'Use nested data properties instead.',
          this
        );
      };
      propsDef.set = function () {
        warn("$props is readonly.", this);
      };
    }
    Object.defineProperty(Vue.prototype, '$data', dataDef);
    Object.defineProperty(Vue.prototype, '$props', propsDef);
```

> eventMixin
è®¾ç½®äº†$on,$once,$off,$emitæ–¹æ³•

> 
è®¾ç½®äº†$forceUpdate , $destroyæ–¹æ³•

> renderMixin

è®¾ç½®äº†$nextTickæ–¹æ³•ã€‚
å…¶ä¸­æœ‰ä¸ªå‡½æ•°åŠ äº†å¾ˆå¤šå¸®åŠ©æ–¹æ³•ã€‚
```js
installRenderHelpers(Vue.prototype)
```
```js
  function installRenderHelpers (target) {
    target._o = markOnce;
    target._n = toNumber;
    target._s = toString;
    target._l = renderList;
    target._t = renderSlot;
    target._q = looseEqual;
    target._i = looseIndexOf;
    target._m = renderStatic;
    target._f = resolveFilter;
    target._k = checkKeyCodes;
    target._b = bindObjectProps;
    target._v = createTextVNode;
    target._e = createEmptyVNode;
    target._u = resolveScopedSlots;
    target._g = bindObjectListeners;
    target._d = bindDynamicKeys;
    target._p = prependModifier;
  }
```





